# 图像分析实验全集

[![Python 3.8](https://img.shields.io/badge/Python-3.8-blue.svg)](https://www.python.org/)  
[![TensorFlow 2.10](https://img.shields.io/badge/TensorFlow-2.10-orange.svg)](https://www.tensorflow.org/)  
[![OpenCV 4.6](https://img.shields.io/badge/OpenCV-4.6-green.svg)](https://opencv.org/)

---

## 项目概览

本仓库包含了 **6 个图像分析实验**，展示了在不同场景下如何运用深度学习（主要是卷积神经网络 CNN）进行图像分类。  
实验内容涵盖了数据预处理、模型构建、训练、评估以及最终预测的完整流程。  
其中，第一个实验为 **水质检测实验**；  
第二个实验为 **德国交通标志分类**；  
其余实验可视具体应用场景进行扩展与修改。

---

## 实验目录

1. [图像分析实验1 - 水质检测实验](#图像分析实验1---水质检测实验)
2. [图像分析实验2 - 德国交通标志分类](#图像分析实验2---德国交通标志分类)
3. [图像分析实验3](#图像分析实验3)
4. [图像分析实验4](#图像分析实验4)
5. [图像分析实验5](#图像分析实验5)
6. [图像分析实验6](#图像分析实验6)

---

## 图像分析实验1 - 水质检测实验

### 项目背景

数据集中包含一个文件夹存放所有的水质图片，每张图片的文件名以一个数字开头，该数字代表水质类别，其后随图片编号（每个类别约 50 张图像）。  
实验主要目标为：  
- 对图像进行预处理（统一调整为 128×128 的大小，并依据文件名确定类别标签）；  
- 构建并训练一个 CNN 模型对水质图片进行分类；  
- 按 80%/20% 划分数据集作为训练集和测试集，对模型性能进行评价；  
- 对新的测试图片进行预测，并直观展示预测结果与实际类别。

### 实验流程

1. **数据预处理**  
   - 利用 Python 的 `os` 模块遍历数据文件夹中的所有图片；  
   - 使用 OpenCV 读取图片并将其统一调整为 128×128；  
   - 根据文件名的首字符确定图片所属类别；  
   - 随机打乱数据后，按 80% 作为训练集、20% 作为测试集进行划分。

2. **模型构建与训练**  
   - 构建 CNN 模型，其主要结构包括：  
     - **输入层**：形状为 (128, 128, 3)（RGB 三通道）；  
     - **卷积层**：采用 32 个 3×3 卷积核，使用 ReLU 激活；  
     - **池化层**：使用 2×2 的最大池化，减少特征图尺寸；  
     - **展平层**：将二维特征图展平成一维向量；  
     - **全连接层**：首先一层包含 128 个神经元（ReLU 激活），接着输出层包含 5 个神经元（对应 5 个类别，采用 softmax 激活）。  
   - 编译模型时采用 `sparse_categorical_crossentropy` 作为损失函数、Adam 优化器以及 accuracy 指标；  
   - 采用 batch size 为 16，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型，并利用 Matplotlib 绘制训练与验证准确率的变化曲线；  
   - 保存训练好的模型，并加载后对新的测试图片进行预测；  
   - 最后展示测试图片及其预测结果（标题中标明实际类别与预测类别）。

### 实验结果

1. **模型训练结果**  
   
   ![训练结果](https://github.com/user-attachments/assets/94867d31-9369-4fd8-a486-c2352c5921bc)
   
2. **模型测试结果**

   ![测试结果1](https://github.com/user-attachments/assets/8967f24f-da60-4bd0-b631-5f86f741a0e2)  
   ![测试结果2](https://github.com/user-attachments/assets/931b96ed-a0aa-431f-970d-61a7f1dcd139)

---

## 图像分析实验2 - 德国交通标志分类

### 项目背景

该实验的数据集仅提供训练集，共划分为 43 个文件夹（编号从 0 到 42），每个文件夹内存放着对应类别的德国交通标志图片，且图片尺寸不一。  
鉴于数据集的特点，需要对数据进行划分和预处理，以便于后续模型的训练和评估。

### 实验流程

1. **数据预处理**  
   - 使用 Python 的 OS 库遍历每个文件夹中的所有图片；  
   - 利用 OpenCV 读取图片，并调整为统一的 32×32 大小；  
   - 利用 NumPy 对图片数据进行归一化处理，并将文件夹名称（代表类别编号）作为标签；  
   - 将数据集按照 80% 作为训练集、20% 作为测试集进行划分，并随机打乱数据顺序，提高模型训练的鲁棒性。

2. **模型构建与训练**  
   - 构建 CNN 模型，主要结构如下：  
     - **输入层**：设定输入尺寸为 32×32，具有 RGB 三个通道；  
     - **卷积层**：采用 32 个 3×3 卷积核，提取图像局部特征；  
     - **池化层**：采用大小为 2×2 的最大池化窗口，降低特征图维度；  
     - **展平层**：将二维特征图展平成一维向量；  
     - **全连接层**：第一层包含 128 个神经元，第二层包含 43 个神经元，输出 43 个类别的概率分布。  
   - 模型编译时使用交叉熵损失函数，Adam 优化器，并以 accuracy 作为模型评估指标；  
   - 设置 batch size 为 32，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型性能；  
   - 使用 PTL 库（或其他图像处理工具）读取并预处理测试图片，确保其大小为 32×32；  
   - 将预处理后的测试图片输入模型进行预测，并输出预测类别。

### 实验结果
1. **模型训练结果**  

<img width="683" alt="11" src="https://github.com/user-attachments/assets/d61aa9dd-6cae-46e0-b42f-eb4d9464b949" />


   
2. **模型测试结果**

<img width="427" alt="111" src="https://github.com/user-attachments/assets/3c356037-d848-4d40-9e3f-da36312f75c3" />


---

## 图像分析实验3 - 人脸识别实验

### 项目背景

本实验利用 Dlib 的预训练模型，实现对输入图像中人脸的检测与标注。  
主要流程包括读取彩色图像后转换为灰度图、检测人脸区域，并使用形状预测模型获取每张人脸的68个面部特征点，然后在图像上绘制这些特征点进行展示。

### 实验流程

1. **读取并转换图像**  
   - 使用 OpenCV 读取图像文件，并转换为灰度图像。

2. **创建检测器与形状预测器**  
   - 初始化 Dlib 的前脸检测器；  
   - 加载 Dlib 的预训练形状预测模型（用于检测人脸的68个特征点）。

3. **检测人脸并标注特征点**  
   - 在灰度图像中使用 `detector(gray, 1)` 检测所有人脸，返回每个人脸的矩形区域列表；  
   - 对于每个检测到的人脸区域，利用形状预测器获取68个特征点；  
   - 遍历每个特征点，打印其坐标，并在原图上绘制小圆圈标注特征点。

4. **显示结果**  
   - 使用 OpenCV 显示带有标注特征点的图像窗口；  
   - 通过 `cv2.waitKey(0)` 等待用户按键，随后调用 `cv2.destroyAllWindows()` 关闭



### 实验结果
![image](https://github.com/user-attachments/assets/786ed015-b9de-4740-ba5c-d47f29605138)
![image](https://github.com/user-attachments/assets/efa0394d-4776-4c85-9277-34662b6cb0d8)

