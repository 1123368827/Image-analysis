# 图像分析实验全集

[![Python 3.8](https://img.shields.io/badge/Python-3.8-blue.svg)](https://www.python.org/)  
[![TensorFlow 2.10](https://img.shields.io/badge/TensorFlow-2.10-orange.svg)](https://www.tensorflow.org/)  
[![OpenCV 4.6](https://img.shields.io/badge/OpenCV-4.6-green.svg)](https://opencv.org/)

---

## 项目概览

本仓库包含了 **6 个图像分析实验**，展示了不同场景下基于深度学习（主要是卷积神经网络 CNN）的图像处理与分类方案。其中，第一个实验为**水质检测实验**，其余实验涵盖其他图像分析任务（如物体识别、场景分类、医学影像分析等），采用了类似的端到端流程：数据预处理、模型构建、训练、评估与预测。

---

## 实验目录

1. [图像分析实验1：水质检测实验](#图像分析实验1-水质检测实验)
2. [图像分析实验2](#图像分析实验2)
3. [图像分析实验3](#图像分析实验3)
4. [图像分析实验4](#图像分析实验4)
5. [图像分析实验5](#图像分析实验5)
6. [图像分析实验6](#图像分析实验6)

---

## 图像分析实验1 - 水质检测实验

### 项目背景

数据集中包含一个文件夹存放所有的水质图片，每张图片的文件名以一个数字开头，该数字代表水质类别，其后随图片编号（每个类别约 50 张图像）。实验主要目标为：
- 对图像进行预处理（统一调整为 128×128 的大小，并依据文件名确定类别标签）；
- 构建并训练一个 CNN 模型对水质图片进行分类；
- 使用 80% 的数据作为训练集、20% 的数据作为测试集，并评估模型性能；
- 对新的测试图片进行预测，并以图像形式展示预测结果与实际类别对比。

### 实验流程

1. **数据预处理**  
   - 利用 Python 的 `os` 模块遍历数据文件夹中的所有图片；
   - 使用 OpenCV 读取并将每张图片调整为 128×128；
   - 根据文件名首字符确定图片所属类别；
   - 随机打乱数据后，按 80%/20% 划分训练集与测试集。

2. **模型构建与训练**  
   - 构建 CNN 模型，架构包括：
     - **输入层**：形状为 (128, 128, 3)（RGB 三通道）；
     - **卷积层**：32 个 3×3 卷积核，激活函数 ReLU；
     - **池化层**：2×2 最大池化；
     - **展平层**：将二维特征图展平；
     - **全连接层**：128 个神经元（ReLU 激活）后接 5 个神经元的输出层（softmax 激活）。
   - 使用 `sparse_categorical_crossentropy` 作为损失函数和 Adam 优化器进行模型编译；
   - 采用 batch size 为 16，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型，并使用 Matplotlib 绘制训练与验证准确率曲线；
   - 模型训练后保存权重，并加载后对新测试图片进行预测；
   - 显示原图并在标题中标出实际类别与预测类别。

### 实验结果

1. **模型训练结果**  
   
   ![训练结果](https://github.com/user-attachments/assets/94867d31-9369-4fd8-a486-c2352c5921bc)
   
2. **模型测试结果**

   ![测试结果1](https://github.com/user-attachments/assets/8967f24f-da60-4bd0-b631-5f86f741a0e2)  
   ![测试结果2](https://github.com/user-attachments/assets/931b96ed-a0aa-431f-970d-61a7f1dcd139)

---

## 图像分析实验2

### 项目背景

本实验针对另一图像分析任务（如物体识别或场景分类）。数据预处理与划分方法与实验1类似，均采用 128×128 的统一尺寸并利用文件命名规则确定类别。

### 实验流程

1. **数据预处理**  
   - 使用 `os` 和 OpenCV 完成图片读取、尺寸调整与标签赋值；
   - 随机打乱后根据 80%/20% 划分训练与测试数据。

2. **模型构建与训练**  
   - 构造与实验1相似的 CNN 模型架构；
   - 采用相同的损失函数、优化器和训练参数进行训练。

3. **模型评估与预测**  
   - 在测试集上评估模型性能，并绘制相关准确率图；
   - 加载模型后对新测试图片进行预测展示。

### 实验结果

- **训练与测试结果示例**：  
  ![测试结果示例](https://github.com/user-attachments/assets/8967f24f-da60-4bd0-b631-5f86f741a0e2)

---

## 图像分析实验3

### 项目背景

本实验依旧关注图像分类任务，可针对不同场景或数据集（例如：室内场景、交通标识等），采用类似的预处理和模型训练流程。

### 实验流程及结果

流程与前两个实验一致。  
- **数据预处理**：图片统一调整、打乱及 80%/20% 划分。  
- **模型构建**：CNN 模型构架相同。  
- **模型训练与评估**：训练曲线与测试图示均在实验中展示。

---

## 图像分析实验4

### 项目背景

本实验针对另一类图像数据集，实验流程与前述实验保持一致，但可能在超参数、数据增强等细节上略有调整，以适应不同的数据特性。

### 实验流程及结果

- **数据预处理**：统一调整尺寸与标签确定，数据划分保持 80%/20%。  
- **模型构建与训练**：采用标准 CNN 模型，并进行参数微调。  
- **评估与预测**：在测试集上的表现通过曲线图和预测图片展示。

---

## 图像分析实验5

### 项目背景

本实验聚焦于特定应用场景的图像分析任务（例如：医学影像或遥感图像分析），流程依然包括数据预处理、CNN 模型构建、训练、评估及预测。

### 实验流程及结果

流程步骤与前述类似，最终结果通过准确率曲线与预测结果对比进行展示。

---

## 图像分析实验6

### 项目背景

最后，本实验针对另一种图像分类任务展开。数据预处理、模型构建、训练及预测均按照类似流程执行，旨在展示模型在不同场景下的泛化能力。

### 实验流程及结果

- 数据预处理和训练流程与前述实验一致；  
- 通过观察训练与验证曲线及测试图片的预测结果，对模型性能进行直观评估。

---

## 环境依赖

- **Python 3.8**  
- **TensorFlow 2.10**  
- **OpenCV 4.6**  
- **Keras**  
- **NumPy**  
- **Matplotlib**

请确保在运行代码前已安装上述依赖库。

---

## 总结与展望

这6个图像分析实验展示了从数据预处理、模型构建、训练评估到预测应用的完整流程。通过对不同图像分析任务的探索，验证了基于CNN的深度学习方法在多种场景中的有效性。未来工作可进一步扩充数据集、深入探索模型结构优化、以及尝试更复杂的数据增强与实时应用系统，以提升图像分类的准确性与泛化能力。

该实验合集展示了扎实的图像处理与深度学习技能，是展示技术实力与多样化项目经验的有力证明。
