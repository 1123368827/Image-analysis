# 🌊 水质智能检测系统 - 基于深度学习的图像分类

[![Python 3.8](https://img.shields.io/badge/Python-3.8-blue.svg)](https://www.python.org/)
[![TensorFlow 2.10](https://img.shields.io/badge/TensorFlow-2.10-orange.svg)](https://www.tensorflow.org/)
[![OpenCV 4.6](https://img.shields.io/badge/OpenCV-4.6-green.svg)](https://opencv.org/)

# 水质检测实验

本项目基于卷积神经网络（CNN），实现了对水质图片的分类检测。通过对水质图像进行预处理、模型设计、训练及评估，最终实现对未知样本的预测，展示了端到端的深度学习项目实现流程。

---

## 项目背景

数据集中包含一个文件夹存放所有的水质图片，每张图片的文件名以一个数字开头，该数字代表水质类别，其后随图片编号（每个类别大约 50 张图像）。项目主要目标为：
- 对图像进行预处理（统一调整为 128×128 的大小，并依据文件名确定类别标签）；
- 构建并训练一个 CNN 模型对图像进行分类；
- 使用 80% 的数据作为训练集、20% 的数据作为测试集，并评估模型性能；
- 对新的测试图片进行预测，并以图像形式展示预测结果与实际类别对比。

---

## 项目思路与步骤

1. **数据预处理**  
   - 使用 Python `os` 模块遍历数据文件夹中的所有图片。
   - 利用 OpenCV 读取图片，将每张图片调整为统一尺寸 128×128。
   - 根据文件名首字符确定每张图片的类别。
   - 随机打乱数据后，划分出 80% 的训练数据和 20% 的测试数据。

2. **模型构建与训练**  
   - 构造 CNN 模型，结构如下：
     - **输入层**：输入尺寸为 (128, 128, 3)，对应 RGB 三个通道。
     - **卷积层**：采用 32 个大小为 3×3 的卷积核，激活函数为 ReLU。
     - **池化层**：使用最大池化，窗口大小为 2×2，用于降低特征图尺寸。
     - **展平层**：将二维特征图展开为一维向量。
     - **全连接层**：第一个全连接层有 128 个神经元（ReLU 激活），第二个全连接层输出 5 个神经元（对应 5 个类别，采用 softmax 激活）。
   - 编译模型时选择 `sparse_categorical_crossentropy` 损失函数、Adam 优化器以及准确率（accuracy）评估指标。
   - 利用 batch_size 为 16，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型性能，并用 Matplotlib 绘制训练及验证过程中的准确率变化曲线。
   - 模型训练完毕后保存模型，并加载模型对新的测试图片进行预测。
   - 最终，使用 Matplotlib 将预测结果与实际类别一起显示，直观展示模型效果。

---
