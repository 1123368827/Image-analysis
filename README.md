# 图像分析实验全集

[![Python 3.8](https://img.shields.io/badge/Python-3.8-blue.svg)](https://www.python.org/)  
[![TensorFlow 2.10](https://img.shields.io/badge/TensorFlow-2.10-orange.svg)](https://www.tensorflow.org/)  
[![OpenCV 4.6](https://img.shields.io/badge/OpenCV-4.6-green.svg)](https://opencv.org/)

---

## 项目概览

本仓库包含了 **6 个图像分析实验**，展示了在不同场景下如何运用深度学习（主要是卷积神经网络 CNN）进行图像分类。  
实验内容涵盖了数据预处理、模型构建、训练、评估以及最终预测的完整流程。  
其中，第一个实验为 **水质检测实验**；  
第二个实验为 **德国交通标志分类**；  
其余实验可视具体应用场景进行扩展与修改。

---

## 实验目录

1. [图像分析实验1 - 水质检测实验](#图像分析实验1---水质检测实验)
2. [图像分析实验2 - 德国交通标志分类](#图像分析实验2---德国交通标志分类)
3. [图像分析实验3](#图像分析实验3)
4. [图像分析实验4](#图像分析实验4)
5. [图像分析实验5](#图像分析实验5)
6. [图像分析实验6](#图像分析实验6)

---

## 图像分析实验1 - 水质检测实验

### 项目背景

数据集中包含一个文件夹存放所有的水质图片，每张图片的文件名以一个数字开头，该数字代表水质类别，其后随图片编号（每个类别约 50 张图像）。  
实验主要目标为：  
- 对图像进行预处理（统一调整为 128×128 的大小，并依据文件名确定类别标签）；  
- 构建并训练一个 CNN 模型对水质图片进行分类；  
- 按 80%/20% 划分数据集作为训练集和测试集，对模型性能进行评价；  
- 对新的测试图片进行预测，并直观展示预测结果与实际类别。

### 实验流程

1. **数据预处理**  
   - 利用 Python 的 `os` 模块遍历数据文件夹中的所有图片；  
   - 使用 OpenCV 读取图片并将其统一调整为 128×128；  
   - 根据文件名的首字符确定图片所属类别；  
   - 随机打乱数据后，按 80% 作为训练集、20% 作为测试集进行划分。

2. **模型构建与训练**  
   - 构建 CNN 模型，其主要结构包括：  
     - **输入层**：形状为 (128, 128, 3)（RGB 三通道）；  
     - **卷积层**：采用 32 个 3×3 卷积核，使用 ReLU 激活；  
     - **池化层**：使用 2×2 的最大池化，减少特征图尺寸；  
     - **展平层**：将二维特征图展平成一维向量；  
     - **全连接层**：首先一层包含 128 个神经元（ReLU 激活），接着输出层包含 5 个神经元（对应 5 个类别，采用 softmax 激活）。  
   - 编译模型时采用 `sparse_categorical_crossentropy` 作为损失函数、Adam 优化器以及 accuracy 指标；  
   - 采用 batch size 为 16，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型，并利用 Matplotlib 绘制训练与验证准确率的变化曲线；  
   - 保存训练好的模型，并加载后对新的测试图片进行预测；  
   - 最后展示测试图片及其预测结果（标题中标明实际类别与预测类别）。

### 实验结果

1. **模型训练结果**  
   
   ![训练结果](https://github.com/user-attachments/assets/94867d31-9369-4fd8-a486-c2352c5921bc)
   
2. **模型测试结果**

   ![测试结果1](https://github.com/user-attachments/assets/8967f24f-da60-4bd0-b631-5f86f741a0e2)  
   ![测试结果2](https://github.com/user-attachments/assets/931b96ed-a0aa-431f-970d-61a7f1dcd139)

---

## 图像分析实验2 - 德国交通标志分类

### 项目背景

该实验的数据集仅提供训练集，共划分为 43 个文件夹（编号从 0 到 42），每个文件夹内存放着对应类别的德国交通标志图片，且图片尺寸不一。  
鉴于数据集的特点，需要对数据进行划分和预处理，以便于后续模型的训练和评估。

### 实验流程

1. **数据预处理**  
   - 使用 Python 的 OS 库遍历每个文件夹中的所有图片；  
   - 利用 OpenCV 读取图片，并调整为统一的 32×32 大小；  
   - 利用 NumPy 对图片数据进行归一化处理，并将文件夹名称（代表类别编号）作为标签；  
   - 将数据集按照 80% 作为训练集、20% 作为测试集进行划分，并随机打乱数据顺序，提高模型训练的鲁棒性。

2. **模型构建与训练**  
   - 构建 CNN 模型，主要结构如下：  
     - **输入层**：设定输入尺寸为 32×32，具有 RGB 三个通道；  
     - **卷积层**：采用 32 个 3×3 卷积核，提取图像局部特征；  
     - **池化层**：采用大小为 2×2 的最大池化窗口，降低特征图维度；  
     - **展平层**：将二维特征图展平成一维向量；  
     - **全连接层**：第一层包含 128 个神经元，第二层包含 43 个神经元，输出 43 个类别的概率分布。  
   - 模型编译时使用交叉熵损失函数，Adam 优化器，并以 accuracy 作为模型评估指标；  
   - 设置 batch size 为 32，训练 10 个 Epoch。

3. **模型评估与预测**  
   - 在测试集上评估模型性能；  
   - 使用 PTL 库（或其他图像处理工具）读取并预处理测试图片，确保其大小为 32×32；  
   - 将预处理后的测试图片输入模型进行预测，并输出预测类别。

### 实验结果

（在此处可以添加训练过程曲线、测试指标以及预测示例图片，以直观展示模型表现。）

---

## 图像分析实验3

### 项目背景

（本实验针对另一图像分析任务，如室内场景识别、物体检测等。数据与预处理流程类似，但可根据具体任务进行微调。）

### 实验流程及结果

- **数据预处理**：调整图片尺寸、归一化、数据打乱与 80%/20% 划分。  
- **模型构建**：采用类似的 CNN 架构进行图像特征提取与分类。  
- **评估与预测**：展示训练过程曲线和测试预测效果。

---

## 图像分析实验4

### 项目背景

（本实验针对特定场景图像的分类任务，可能涉及不同的数据增强策略或网络结构调整。）

### 实验流程及结果

- 数据预处理与划分与前述实验一致；  
- 模型构建与超参数调整略有不同，以适应具体数据分布；  
- 展示训练和测试结果以验证模型性能。

---

## 图像分析实验5

### 项目背景

（本实验侧重于应用深度学习进行复杂图像（如医学影像或遥感图像）的分类，通过扩展数据集和优化模型结构提升预测准确率。）

### 实验流程及结果

- 类似的数据预处理流程；  
- 使用改进的 CNN 模型或预训练网络进行特征提取；  
- 展示模型训练曲线与测试预测的具体结果。

---

## 图像分析实验6

### 项目背景

（本实验针对另一图像分类任务，探索模型在不同数据集下的泛化能力和鲁棒性。）

### 实验流程及结果

- 数据预处理和训练方法与前述实验基本一致；  
- 对模型进行了不同参数设置的对比实验；  
- 最终通过训练及测试结果展示模型效果。

---

## 环境依赖

- **Python 3.8**  
- **TensorFlow 2.10**  
- **OpenCV 4.6**  
- **Keras**  
- **NumPy**  
- **Matplotlib**

请确保在运行代码前已安装上述依赖库。

---

## 总结与展望

本实验全集展示了从数据预处理、模型构建、训练与评估到最终预测应用的完整图像分析流程。通过不同实验，可以看到基于 CNN 的深度学习方法在多种应用场景下的有效性。  
未来的工作可进一步探索：  
- 数据集扩充与数据增强策略；  
- 网络结构优化与超参数调优；  
- 实时处理与在线监控系统的集成。

该项目集充分体现了扎实的图像处理和深度学习技能，是展示技术实力和多样化项目经验的有力证明。
